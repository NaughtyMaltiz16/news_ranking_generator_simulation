<!DOCTYPE html>
<html lang="ko" data-lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NewsRanking â€“ ì°¨íŠ¸ì—ì„œ ë°”ë¡œ ë³´ëŠ” ì½”ìŠ¤í”¼ ì´ìŠˆ</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="tooplate-eco-lume.css">

  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <nav>
    <div class="nav-inner">
      <div class="nav-left">
        <div class="logo-badge"></div>
        <div class="brand">ë‰´ìŠ¤ë­í‚¹ì œë„ˆë ˆì´í„°</div>
      </div>

      <button id="menuToggle" aria-label="ë©”ë‰´ ì—´ê¸°">â˜°</button>

      <ul class="nav-menu" id="navMenu">
        <li><a class="nav-link" href="#demo">ë°ëª¨</a></li>
        <li><a class="nav-link" href="#features">ê¸°ëŠ¥</a></li>
        <li><a class="nav-link" href="#how">ë™ì‘ ë°©ì‹</a></li>
        <li><a class="nav-link" href="#feedback">í”¼ë“œë°±</a></li>
      </ul>
    </div>
  </nav>

  <section class="hero" id="home">
    <div class="hero-inner">
      <div class="hero-text">
        <div class="eyebrow">ìº”ë“¤ì„ í´ë¦­í•˜ë©´ ë°”ë¡œ ëœ¨ëŠ”, ê·¸ë‚ ì˜ ì´ìŠˆ</div>

        <h1 class="hero-title">
          ì†ì‹¤ì€ ì‹¤ì‹œê°„ìœ¼ë¡œ ë³´ë©´ì„œ,<br>
          ì™œ ê·¸ëŸ°ì§€ëŠ” ë‚˜ì¤‘ì— ì°¾ê³  ìˆë‚˜ìš”?
        </h1>

        <div class="product-name">
          ë‰´ìŠ¤ë­í‚¹ì œë„ˆë ˆì´í„°
        </div>

        <p class="hero-sub">
          ë‚´ ì§‘ ë§ˆë ¨ë„, ì€í‡´ë„ ê²°êµ­ <b>íˆ¬ìê°€ ë’·ë°›ì¹¨í•´ì•¼ í•˜ëŠ” ì‹œëŒ€</b>ì…ë‹ˆë‹¤.<br>
          ì‹œì¥ì´ ì™œ ì›€ì§ì˜€ëŠ”ì§€ ëª¨ë¥¸ ì±„ ê°ìœ¼ë¡œ ë§¤ë§¤í•˜ëŠ” ê±´
          ìƒê°ë³´ë‹¤ ë¹„ì‹¼ ê³µë¶€ê°€ ë©ë‹ˆë‹¤.<br><br>
          ìº”ë“¤ì„ ì§šì–´ì£¼ë©´ ê·¸ë‚ ì˜ <span class="product-tag">ë‰´ìŠ¤ ê¸°ì‚¬ TOP5</span>ì™€<br>
          ì£¼ìš” ì´ë²¤íŠ¸ë¥¼ í•œ í™”ë©´ì— ì •ë¦¬í•´ ë“œë¦½ë‹ˆë‹¤.
        </p>

        <div class="hero-buttons">
          <a href="#demo" class="btn btn-primary">ë°ëª¨ ë°”ë¡œ ë³´ê¸°</a>
        </div>
      </div>
    </div>
  </section>

  <section id="demo">
    <div class="section-wrap">
      <h2 class="section-title">ë¼ì´ë¸Œ ë°ëª¨</h2>
      <div id="demo-root"></div>
    </div>
  </section>

  <section id="reviews">
    <div class="section-wrap reviews-inner">
      <h2 class="reviews-title">ë¨¼ì € ì¨ë³¸ ì‚¬ëŒë“¤ì˜ í•œ ì¤„ ë¦¬ë·°</h2>
      <p class="reviews-sub">
        ì‹¤ì œë¡œ ì¨ ë³¸ ì‚¬ìš©ìë“¤ì˜ ì†”ì§í•œ í›„ê¸°ì…ë‹ˆë‹¤.  
        ì£¼ì‹ ì…ë¬¸ìë¶€í„° ë¦¬í¬íŠ¸ë¥¼ ì¤€ë¹„í•˜ëŠ” ì¸í„´ê¹Œì§€! ëª¨ë‘ ë‹¤ ì§ì ‘ ì¨ ë³´ê³  ì†Œì¤‘í•œ ë¦¬ë·°ë¥¼ ë‚¨ê²¨ì¤¬ìŠµë‹ˆë‹¤.
      </p>

      <div class="reviews-list">
        <article class="review-card">
          <div class="review-meta">ê²½ì œí•™ê³¼ ëŒ€í•™ìƒ</div>
          <div class="review-name">ê¶Œ00</div>
          <p class="review-text">
            ì£¼ì‹ ì°¨íŠ¸ë‘ ì‹œì‚¬ ë‰´ìŠ¤ë¥¼ í•œ ë²ˆì— ë³¼ ìˆ˜ ìˆì–´ì„œ, ì‹œì¥ ê°ê° ê¸°ë¥´ê¸°ì— ì •ë§ ì¢‹ì•„ìš”!
          </p>
        </article>

        <article class="review-card">
          <div class="review-meta">ì¦ê¶Œì‚¬ ì¸í„´</div>
          <div class="review-name">ê¹€00</div>
          <p class="review-text">
            ë§¤ì¼ ì•„ì¹¨ ë¦¬í¬íŠ¸ìš© ìë£Œë¥¼ ì°¾ëŠ”ë°,
            ê´€ë ¨ ì´ìŠˆë¥¼ í•œ í™”ë©´ì—ì„œ ì •ë¦¬í•´ ë³¼ ìˆ˜ ìˆì–´ ìë£Œ ì°¾ëŠ” ì‹œê°„ì´ í™• ì¤„ì—ˆì–´ìš”.
          </p>
        </article>

        <article class="review-card">
          <div class="review-meta">ì£¼ì‹ ì…ë¬¸ 1ê°œì›” ì°¨</div>
          <div class="review-name">ì´00</div>
          <p class="review-text">
            ì£¼ì‹ ê³µë¶€ ì‹œì‘í•œ ì§€ ì–¼ë§ˆ ì•ˆ ëëŠ”ë°,<br>
            ì°¨íŠ¸ë‘ ê°™ì´ ì •ë¦¬ëœ ë‰´ìŠ¤Â·ìš©ì–´ë¥¼ ë³´ë‹ˆê¹Œ ê³µë¶€í•  ë•Œ í° ë„ì›€ì´ ë¼ìš”.
          </p>
        </article>
      </div>
    </div>
  </section>

  <section id="features">
    <div class="section-wrap">
      <h2 class="section-title">í•µì‹¬ ê¸°ëŠ¥</h2>
      <div class="cards-grid">
        <div class="card">
          <h3>ìº”ë“¤ â†’ í† í”½ ë­í‚¹</h3>
          <p>
            í•´ë‹¹ì¼ ê¸°ì‚¬ë¥¼ ì„ë² ë”©Â·í´ëŸ¬ìŠ¤í„°ë§í•˜ê³  <b>ë³¼ë¥¨Â·ì†ë„Â·ì‹ ê·œì„±Â·ê°ì„±Â·ê´€ë ¨ì„±</b>ì„ ë°˜ì˜í•´  
            TOP5 í† í”½ì„ ì‚°ì¶œí•©ë‹ˆë‹¤.
          </p>
        </div>
        <div class="card">
          <h3>ê²€ìƒ‰ì–´ TOP5</h3>
          <p>
            ì¢…ëª©/í‹°ì»¤/ì„¹í„° ê¸°ì¤€ ì¼ê°„ ê²€ìƒ‰ íŠ¸ë Œë“œë¥¼ ì§‘ê³„í•´  
            ìƒìœ„ 5ê°œ í‚¤ì›Œë“œë¥¼ ë°”ë¡œ ë³´ì—¬ì¤ë‹ˆë‹¤.
          </p>
        </div>
        <div class="card">
          <h3>ì¤‘ìš” ì¼ì • í•€</h3>
          <p>
            ê¸ˆë¦¬ ê²°ì •, ì‹¤ì  ë°œí‘œ, ì£¼ì£¼ì´íšŒ, ì§€í‘œ ë°œí‘œ ë“±  
            ì£¼ìš” ì¼ì •ì„ íƒ€ì„ë¼ì¸ì— í•€ í˜•íƒœë¡œ ì œê³µí•©ë‹ˆë‹¤.
          </p>
        </div>
        <div class="card">
          <h3>ê°œì¸í™” ê°€ì¤‘ì¹˜ (í–¥í›„)</h3>
          <p>
            ê´€ì‹¬ ì¢…ëª©Â·ì„¹í„° ê°€ì¤‘ì¹˜ë¥¼ ì¡°ì •í•´  
            ë‚˜ì—ê²Œ ì¤‘ìš”í•œ ì´ìŠˆê°€ ë¨¼ì € ë³´ì´ë„ë¡ ê°œì¸í™”í•©ë‹ˆë‹¤.
          </p>
        </div>
      </div>
    </div>
  </section>

  <section id="how">
    <div class="section-wrap">
      <h2 class="section-title">ì–´ë–»ê²Œ ë™ì‘í•˜ë‚˜ìš”?</h2>
      <div class="how-grid">
        <div class="card step">
          <div class="step-number">1</div>
          <h3>ìˆ˜ì§‘ Â· ì •ì œ</h3>
          <p>
            ì¦ê¶Œ ë‰´ìŠ¤ì™€ ê²€ìƒ‰ íŠ¸ë Œë“œë¥¼ ìˆ˜ì§‘í•œ ë’¤ ì¤‘ë³µì„ ì œê±°í•˜ê³ ,  
            ë¶„ì„ì— í•„ìš”í•œ í•µì‹¬ ë¬¸ì¥ì„ ì¶”ë¦½ë‹ˆë‹¤.
          </p>
        </div>
        <div class="card step">
          <div class="step-number">2</div>
          <h3>í† í”½í™” Â· ë¼ë²¨ë§</h3>
          <p>
            ê¸°ì‚¬ë¥¼ ì„ë² ë”©Â·í´ëŸ¬ìŠ¤í„°ë§í•˜ê³  NERë¡œ ì¢…ëª©Â·ì„¹í„°ë¥¼ ë§¤í•‘í•œ ë’¤,  
            íˆ¬ìì ì¹œí™”ì ì¸ í† í”½ ì œëª©ì„ ìƒì„±í•©ë‹ˆë‹¤.
          </p>
        </div>
        <div class="card step">
          <div class="step-number">3</div>
          <h3>ì ìˆ˜í™” Â· ë™ê¸°í™”</h3>
          <p>
            ì—¬ëŸ¬ ì§€í‘œë¥¼ ì ìˆ˜í™”í•´ ë­í‚¹ì„ ë§Œë“¤ê³ ,  
            ì´ë¥¼ ì½”ìŠ¤í”¼ ì°¨íŠ¸ì™€ ë‚ ì§œë³„ë¡œ ë™ê¸°í™”í•©ë‹ˆë‹¤.
          </p>
        </div>
      </div>
    </div>
  </section>

  <section id="feedback" class="feedback-section">
    <div class="feedback-inner">
      <h2 class="feedback-title">ë³¸ì¸ì˜ ì£¼ì‹ ê³µë¶€ë¥¼ ìœ„í•´ ì–´ë–¤ ë¶€ë¶„ì´ ë” ìˆì—ˆìœ¼ë©´ ì¢‹ì„ê¹Œìš”?</h2>
      <p class="feedback-sub">
        í”¼ë“œë°±ì€ ìµëª…ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤. í¸í•˜ê²Œ ì ì–´ ì£¼ì„¸ìš”.
      </p>

      <div class="feedback-reaction">
        <span class="reaction-label">ì˜¤ëŠ˜ í˜ì´ì§€, ë„ì›€ì´ ë˜ì—ˆë‚˜ìš”?</span>
        <button type="button" id="btn-like" class="reaction-btn reaction-like">
          ğŸ‘ ì¢‹ì•„ìš”
        </button>
        <button type="button" id="btn-dislike" class="reaction-btn reaction-dislike">
          ğŸ‘ ë³„ë¡œì˜ˆìš”
        </button>
        <span id="reaction-status" class="reaction-status"></span>
      </div>

      <form id="feedbackForm" class="feedback-form">
        <label for="feedback-text">í•˜ê³  ì‹¶ì€ ë§</label>
        <textarea id="feedback-text" placeholder="ì˜ˆ: ì°¨íŠ¸ ì•„ë˜ì— ê°œë³„ ì¢…ëª© ì˜ˆì‹œë„ ìˆìœ¼ë©´ ì¢‹ê² ì–´ìš”."></textarea>
        <button type="submit" class="feedback-submit">ìµëª…ìœ¼ë¡œ ì œì¶œí•˜ê¸°</button>
        <p id="feedback-status" class="feedback-status"></p>
      </form>
    </div>
  </section>

  <footer>
    <div class="footer-inner">
      Â© 2025 ë‰´ìŠ¤ë­í‚¹ì œë„ˆë ˆì´í„°. All rights reserved.
    </div>
  </footer>

  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script>
    const addrScript = "https://script.google.com/macros/s/AKfycbxmOTzzMXW94DTcwVlu5zZ_-zmCAo4SJf8Pu5y-vhg3pz63W6L_X-9l3WIlUU3V9t6A/exec";
    const mobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ? "mobile" : "desktop";
    function getCookieValue(name) {
      const v = "; " + document.cookie;
      const parts = v.split("; " + name + "=");
      if (parts.length === 2) return parts.pop().split(";").shift();
    }
    function setCookieValue(name, value, days) {
      let expires = "";
      if (days) {
        const d = new Date();
        d.setTime(d.getTime() + days*24*60*60*1000);
        expires = "; expires=" + d.toUTCString();
      }
      document.cookie = name + "=" + (value || "") + expires + "; path=/";
    }
    function getUVfromCookie(){
      const tmp = Math.random().toString(36).substring(2, 8).toUpperCase();
      const existing = getCookieValue("user");
      if (!existing) {
        setCookieValue("user", tmp, 180);
        return tmp;
      }
      return existing;
    }
    function pad(v){ return v < 10 ? "0" + v : v; }
    function getTimeStamp(){
      const d = new Date();
      return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
    }

    $(document).ready(function(){
      const menuToggle = document.getElementById("menuToggle");
      const navMenu = document.getElementById("navMenu");
      if (menuToggle && navMenu) {
        menuToggle.addEventListener("click", () => navMenu.classList.toggle("active"));
        document.querySelectorAll(".nav-link").forEach(a =>
          a.addEventListener("click", () => navMenu.classList.remove("active"))
        );
      }

      // â‘  ì—¬ê¸° â†“â†“â†“ ì´ ë¸”ë¡ì´ ë°©ë¬¸ì ê¸°ë¡ìš©
      (function logVisitor() {
        const data = {
          id: getUVfromCookie(),
          landingUrl: window.location.href,
          referer: document.referrer || "",
          time_stamp: getTimeStamp(),
          utm: window.location.search || "",
          device: mobile
        };

        axios.get(
          addrScript +
            "?action=insert&table=visitors&data=" +
            encodeURIComponent(JSON.stringify(data))
        )
        .then(function(res){
          console.log("visitor saved", res && res.data);
        })
        .catch(function(err){
          console.error("visitor log error", err);
        });
      })();
      // â‘  ì—¬ê¸°ê¹Œì§€

      function sendReaction(kind) {
        const data = {
          id: getUVfromCookie(),
          reaction: kind,
          time_stamp: getTimeStamp(),
          page: window.location.pathname,
          device: mobile
        };

        $("#reaction-status").text("ì €ì¥ ì¤‘...");

        axios.get(addrScript + "?action=insert&table=demo_reaction&data=" + encodeURIComponent(JSON.stringify(data)))
          .then(res => {
            console.log("reaction saved", res && res.data);
            $("#reaction-status").text("ì˜ê²¬ì´ ë°˜ì˜ë˜ì—ˆìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤!");
          })
          .catch(err => {
            console.error(err);
            $("#reaction-status").text("ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‚˜ì¤‘ì— ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
          });
      }

      $("#btn-like").on("click", function(){
        $(".reaction-btn").removeClass("active");
        $(this).addClass("active");
        sendReaction("like");
      });

      $("#btn-dislike").on("click", function(){
        $(".reaction-btn").removeClass("active");
        $(this).addClass("active");
        sendReaction("dislike");
      });

      $("#feedbackForm").on("submit", function(e){
        e.preventDefault();
        const msg = $("#feedback-text").val().trim();
        if (!msg) {
          $("#feedback-status").text("í”¼ë“œë°± ë‚´ìš©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
          return;
        }

        const data = {
          id: getUVfromCookie(),
          feedback: msg,
          time_stamp: getTimeStamp(),
          page: window.location.pathname,
          device: mobile
        };

        $("#feedback-status").text("ì œì¶œ ì¤‘...");

        axios.get(addrScript + "?action=insert&table=feedback&data=" + encodeURIComponent(JSON.stringify(data)))
          .then(function(res){
            console.log("feedback saved", res && res.data);
            $("#feedback-status").text("ì˜ ë°›ì•˜ì–´ìš”. ì •ë§ ê°ì‚¬í•©ë‹ˆë‹¤ ğŸ™");
            $("#feedback-text").val("");
          })
          .catch(function(err){
            console.error(err);
            $("#feedback-status").text("ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‚˜ì¤‘ì— ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
          });
      });
    });
  </script>

  <script type="text/babel">
    const { useState, useMemo, useEffect, useRef } = React;

    const REACT_I18N = {
      ko: {
        chart_title: "ì½”ìŠ¤í”¼",
        price_range: "ê°€ê²© êµ¬ê°„",
        legend_up: "ìƒìŠ¹",
        legend_down: "í•˜ë½",
        legend_surge: "ê¸‰ë“± ìº”ë“¤",
        hint_hover: "í˜¸ë²„ë¡œ ë¯¸ë¦¬ ë³´ê¸° â€¢ í´ë¦­ìœ¼ë¡œ ê³ ì • â€¢ ì¢Œìš° ë“œë˜ê·¸ë¡œ ê¸°ê°„ ì´ë™",
        timeline_title: "ì£¼ìš” ì´ë²¤íŠ¸ íƒ€ì„ë¼ì¸",
        timeline_hint: "ì´ë²¤íŠ¸ë¥¼ í´ë¦­í•˜ë©´ í•´ë‹¹ ë‚ ì§œì˜ ìº”ë“¤ì´ ì„ íƒë©ë‹ˆë‹¤.",
        dummy_events_note: "í•œêµ­ì€í–‰ ê¸°ì¤€ê¸ˆë¦¬, ë¯¸êµ­ FOMC, ì†Œë¹„ìë¬¼ê°€ ë™í–¥, ë°°ë‹¹ë½Â·íœ´ì¥ì¼ ë“± ì£¼ìš” ì´ë²¤íŠ¸ë¥¼ í•œëˆˆì— ëª¨ì•„ ë³´ì—¬ì¤ë‹ˆë‹¤.",
        news_panel_title: "ë‰´ìŠ¤ & ê²€ìƒ‰ íŠ¸ë Œë“œ",
        clear: "ì„ íƒ í•´ì œ",
        search_rankings: "ê²€ìƒ‰ íŠ¸ë Œë“œ ë­í‚¹ (ì œê³µ: Nate.com)",
        empty_hint: "ìº”ë“¤ì„ í˜¸ë²„í•˜ê±°ë‚˜ í´ë¦­í•´ ë³´ì„¸ìš”. ì°¨íŠ¸ë¥¼ ì¢Œìš°ë¡œ ë“œë˜ê·¸í•˜ë©´ ë” ë§ì€ ë‚ ì§œë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
        bottom_note: "* ê°€ê²©/ì°¨íŠ¸ëŠ” ë°ëª¨ ë°ì´í„°ì´ë©°, ë‰´ìŠ¤ ê¸°ì‚¬ ì œëª©ì€ ë°±ì—”ë“œì—ì„œ Nate ì‹¤ì‹œê°„ ë­í‚¹ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.",
        type_badge: { rate: "ê¸ˆë¦¬Â·í†µí™”", earnings: "ì‹¤ì ", meeting: "ì£¼ì£¼ì´íšŒ", policy: "ì§€í‘œÂ·ì •ì±…" },
        cat_label: "ì¹´í…Œê³ ë¦¬",
        loading_news: "ì‹¤ì œ ë‰´ìŠ¤ ì œëª©ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤â€¦ì ì‹œë§Œ ê¸°ë‹¬ë ¤ì£¼ì„¸ìš”",
        error_news: "ë‰´ìŠ¤ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",
        table_rank: "ìˆœìœ„",
        table_title: "ê¸°ì‚¬ ì œëª©"
      }
    };

    const CATEGORY_LIST = [
      { code: "all", labelKo: "ì¢…í•©" },
      { code: "eco", labelKo: "ê²½ì œ" },
      { code: "sisa", labelKo: "ì‹œì‚¬" },
      { code: "spo", labelKo: "ìŠ¤í¬ì¸ " },
      { code: "pol", labelKo: "ì •ì¹˜" },
      { code: "soc", labelKo: "ì‚¬íšŒ" },
      { code: "ent", labelKo: "ì—°ì˜ˆ" },
      { code: "int", labelKo: "ì„¸ê³„" },
      { code: "its", labelKo: "IT/ê³¼í•™" }
    ];

    const DAY_MS = 24 * 60 * 60 * 1000;
    const BASE_START = new Date("2025-11-30T00:00:00");

    function indexToDate(idx) {
      const d = new Date(BASE_START.getTime() + idx * DAY_MS);
      return d.toISOString().slice(0, 10);
    }

    function makeSeed(str) {
      let h = 0;
      for (let i = 0; i < str.length; i++) {
        h = (h * 31 + str.charCodeAt(i)) >>> 0;
      }
      return h;
    }

    function rand01(seed, step) {
      const x = Math.sin(seed + step * 101) * 10000;
      return x - Math.floor(x);
    }

    const COMPANY = "KOSPI (ì „ì²´)";

    function buildDummyCandle(dateStr, index) {
      const key = COMPANY + dateStr;
      const seedBase = makeSeed(key);
      const r1 = rand01(seedBase, 1);
      const r2 = rand01(seedBase, 2);
      const r3 = rand01(seedBase, 3);
      const r4 = rand01(seedBase, 4);

      const base = 200 + Math.floor(seedBase % 80);
      const drift = index * 1.2;
      const open = Math.max(10, Math.round(base + drift + (r1 * 6 - 3)));
      let close = Math.max(10, Math.round(open + (r2 * 8 - 4)));
      let high = Math.max(open, close) + Math.round(r3 * 4);
      let low = Math.min(open, close) - Math.round(r4 * 4);

      if (low < 1) low = 1;
      if (high <= low) high = low + 1;

      const volume = 5000000 + Math.floor(seedBase % 5000000);
      const surge = Math.abs(close - open) / open >= 0.04;

      const sectorName = "ì „ ì„¹í„° (ë°ëª¨)";
      const news = [
        `ì½”ìŠ¤í”¼ ì „ì²´ ë°ëª¨ í—¤ë“œë¼ì¸ (${dateStr})`,
        `ì‹œì¥ ì „ë°˜ ì›€ì§ì„ (ë°ëª¨, ${dateStr})`
      ];
      const sectorNews = [
        `${sectorName} ì‹¬ë¦¬ ë³€í™” (${dateStr})`,
        `${sectorName} ë¡œí…Œì´ì…˜ ë°ëª¨ ìŠ¤í† ë¦¬ (${dateStr})`
      ];
      const trends = [];

      return { open, high, low, close, volume, sector: sectorName, surge, news, sectorNews, trends };
    }

    const EVENTS = [
      { date: "2026-01-15", type: "rate", entity: "í•œêµ­ì€í–‰", title: "í•œêµ­ì€í–‰ ê¸°ì¤€ê¸ˆë¦¬ ê²°ì •", time: "09:00", importance: "high" },
      { date: "2026-01-29", type: "rate", entity: "ë¯¸êµ­ FOMC", title: "ë¯¸êµ­ FOMC ê¸°ì¤€ê¸ˆë¦¬ ë°œí‘œ", time: "09:00", importance: "high" },
      { date: "2025-12-31", type: "policy", entity: "í†µê³„ì²­", title: "2025ë…„ 12ì›” ë° ì—°ê°„ ì†Œë¹„ìë¬¼ê°€ ë™í–¥ ë°œí‘œ", time: "08:00", importance: "med" },
      { date: "2025-12-29", type: "meeting", entity: "ì½”ìŠ¤í”¼ ìƒì¥ì‚¬", title: "2025ë…„ ë°°ë‹¹ë½ ê¸°ì¤€ì¼", time: "00:00", importance: "med" },
      { date: "2025-12-31", type: "policy", entity: "í•œêµ­ê±°ë˜ì†Œ", title: "2025ë…„ ì—°ë§ íœ´ì¥ì¼", time: "00:00", importance: "med" }
    ];

    function dateStrToIdx(dateStr) {
      const d = new Date(dateStr + "T00:00:00");
      return Math.round((d.getTime() - BASE_START.getTime()) / DAY_MS);
    }

    function formatNum(n) {
      if (n >= 1e9) return (n / 1e9).toFixed(1) + "B";
      if (n >= 1e6) return (n / 1e6).toFixed(1) + "M";
      if (n >= 1e3) return (n / 1e3).toFixed(1) + "K";
      return String(n);
    }

    const IconInfo = () => (
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="2"></circle>
        <line x1="12" y1="10" x2="12" y2="16" stroke="currentColor" strokeWidth="2"></line>
        <circle cx="12" cy="7" r="1" fill="currentColor"></circle>
      </svg>
    );
    const IconTrend = () => <span role="img" aria-label="trend">ğŸ“ˆ</span>;
    const IconNews = () => <span role="img" aria-label="news">ğŸ“°</span>;
    const IconCalendar = () => <span role="img" aria-label="calendar">ğŸ“…</span>;

    const VISIBLE_COUNT = 5;

    function DemoApp() {
      const T = REACT_I18N.ko;

      const TYPE_BADGE = {
        rate: { label: T.type_badge.rate, class: "bg-indigo-100 text-indigo-700" },
        earnings: { label: T.type_badge.earnings, class: "bg-emerald-100 text-emerald-700" },
        meeting: { label: T.type_badge.meeting, class: "bg-sky-100 text-sky-700" },
        policy: { label: T.type_badge.policy, class: "bg-amber-100 text-amber-700" }
      };
      const IMP_DOT = { low: "bg-gray-300", med: "bg-yellow-400", high: "bg-red-500" };

      const [offset, setOffset] = useState(0);
      const [pixelShift, setPixelShift] = useState(0);
      const [activeIdxAbs, setActiveIdxAbs] = useState(null);
      const [pinnedIdxAbs, setPinnedIdxAbs] = useState(null);

      const [category, setCategory] = useState("eco");
      const [newsCache, setNewsCache] = useState({});
      const dragRef = useRef({ dragging: false, startX: 0, startShift: 0 });

      const width = 800;
      const height = 300;
      const pad = 24;
      const xStep = width / VISIBLE_COUNT;

      const visibleIndices = useMemo(() => {
        const arr = [];
        for (let i = 0; i < VISIBLE_COUNT; i++) {
          arr.push(offset + i);
        }
        return arr;
      }, [offset]);

      const [minP, maxP] = useMemo(() => {
        let min = Infinity;
        let max = -Infinity;
        visibleIndices.forEach(idx => {
          const dateStr = indexToDate(idx);
          const c = buildDummyCandle(dateStr, idx);
          min = Math.min(min, c.low);
          max = Math.max(max, c.high);
        });
        if (!isFinite(min) || !isFinite(max)) return [0, 0];
        return [min, max];
      }, [visibleIndices]);

      const yScale = p => {
        if (!isFinite(minP) || !isFinite(maxP) || maxP === minP) return height / 2;
        return pad + (1 - (p - minP) / (maxP - minP)) * (height - 2 * pad);
      };

      const current = useMemo(() => {
        const idx = pinnedIdxAbs != null ? pinnedIdxAbs : activeIdxAbs;
        if (idx == null) return null;
        const dateStr = indexToDate(idx);
        const c = buildDummyCandle(dateStr, idx);
        return { index: idx, date: dateStr, ...c };
      }, [pinnedIdxAbs, activeIdxAbs]);

      const events = useMemo(() => {
        return EVENTS.map(ev => ({ ...ev, idx: dateStrToIdx(ev.date) }));
      }, []);

      useEffect(() => {
        if (!current) return;

        const key = `${category}-${current.date}`;
        const existing = newsCache[key];
        if (existing && (existing.status === "loading" || existing.status === "ok")) return;

        const dateParam = current.date.replace(/-/g, "");

        setNewsCache(prev => ({
          ...prev,
          [key]: { status: "loading", items: [] }
        }));

        if (typeof axios === "undefined") {
          return;
        }

        axios
          .get(addrScript, {
            params: { action: "nate", sc: category, date: dateParam }
          })
          .then(res => {
            const payload = res.data;
            let titles = [];
            if (payload && payload.success && payload.data && Array.isArray(payload.data.titles)) {
              titles = payload.data.titles;
            }
            setNewsCache(prev => ({
              ...prev,
              [key]: { status: "ok", items: titles }
            }));
          })
          .catch(err => {
            setNewsCache(prev => ({
              ...prev,
              [key]: { status: "error", items: [] }
            }));
          });
      }, [current, category, newsCache]);

      const handleMouseDown = e => {
        dragRef.current.dragging = true;
        dragRef.current.startX = e.clientX;
        dragRef.current.startShift = pixelShift;
      };

      const handleMouseMove = e => {
        if (!dragRef.current.dragging) return;
        const dx = e.clientX - dragRef.current.startX;
        let newShift = dragRef.current.startShift + dx;

        while (newShift > xStep) {
          newShift -= xStep;
          setOffset(prev => prev - 1);
        }
        while (newShift < -xStep) {
          newShift += xStep;
          setOffset(prev => prev + 1);
        }
        setPixelShift(newShift);
      };

      const stopDragging = () => {
        dragRef.current.dragging = false;
        dragRef.current.startShift = pixelShift;
      };

      let trendTitles = [];
      let trendStatus = "idle";
      if (current) {
        const key = `${category}-${current.date}`;
        const cache = newsCache[key];
        if (cache && cache.status === "ok" && cache.items.length > 0) {
          trendStatus = "ok";
          trendTitles = cache.items
            .map(it => (typeof it === "string" ? it : (it && it.title) || ""))
            .filter(Boolean)
            .slice(0, 5);
        } else if (cache) {
          trendStatus = cache.status;
          trendTitles = [];
        }
      }

      return (
        <div className="w-full max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-4">
          <div className="lg:col-span-8 space-y-4">
            <div className="bg-white rounded-2xl shadow p-4 flex items-center justify-between">
              <div>
                <div className="text-xs text-gray-500 font-semibold tracking-wide">
                  ì½”ìŠ¤í”¼ ì‹œì¥ì„ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“  í”„ë¡ íŠ¸ì—”ë“œ ë°ëª¨ì…ë‹ˆë‹¤. ì°¨íŠ¸ë¥¼ ë“œë˜ê·¸í•˜ê³  ì´ë²¤íŠ¸ë¥¼ ëˆŒëŸ¬ ë³´ì„¸ìš”.
                </div>
              </div>
            </div>

            <div className="bg-white rounded-2xl shadow p-4">
              <div className="flex items-center justify-between mb-3">
                <div className="flex items-center gap-2">
                  <IconTrend />
                  <h2 className="text-lg font-semibold">{T.chart_title}</h2>
                </div>
                <div className="text-sm text-gray-500">
                  {T.price_range}:{" "}
                  <span className="font-medium">
                    {minP && maxP ? `${minP}â€“${maxP}` : "â€”"}
                  </span>
                </div>
              </div>

              <div className="flex items-center gap-4 text-xs mb-2">
                <span className="inline-flex items-center gap-1">
                  <span className="inline-block w-3 h-3 rounded bg-green-500"></span> {T.legend_up}
                </span>
                <span className="inline-flex items-center gap-1">
                  <span className="inline-block w-3 h-3 rounded bg-red-500"></span> {T.legend_down}
                </span>
                <span className="inline-flex items-center gap-1">
                  <span className="inline-block w-3 h-3 rounded bg-yellow-400"></span> {T.legend_surge}
                </span>
              </div>

              <div
                className="overflow-x-auto"
                onMouseDown={handleMouseDown}
                onMouseMove={handleMouseMove}
                onMouseUp={stopDragging}
                onMouseLeave={stopDragging}
                style={{ cursor: dragRef.current.dragging ? "grabbing" : "grab" }}
              >
                <svg viewBox={`0 0 ${width} ${height}`} className="w-full h-72 bg-gray-50 rounded-xl select-none">
                  {[0, 0.25, 0.5, 0.75, 1].map((t, i) => (
                    <line
                      key={i}
                      x1={0}
                      x2={width}
                      y1={pad + t * (height - 2 * pad)}
                      y2={pad + t * (height - 2 * pad)}
                      stroke="#e5e7eb"
                    />
                  ))}

                  {visibleIndices.map((idx, i) => {
                    const dateStr = indexToDate(idx);
                    const d = buildDummyCandle(dateStr, idx);

                    const x = i * xStep + xStep / 2 + pixelShift;
                    const isUp = d.close >= d.open;
                    const color = isUp ? "#22c55e" : "#ef4444";
                    const yHigh = yScale(d.high);
                    const yLow = yScale(d.low);
                    const yOpen = yScale(d.open);
                    const yClose = yScale(d.close);

                    const bodyTop = Math.min(yOpen, yClose);
                    const bodyBot = Math.max(yOpen, yClose);
                    const bodyH = Math.max(2, bodyBot - bodyTop);
                    const bodyW = Math.max(6, xStep * 0.4);
                    const isActive = idx === activeIdxAbs || idx === pinnedIdxAbs;

                    return (
                      <g
                        key={dateStr}
                        className="cursor-pointer"
                        onMouseEnter={e => {
                          e.stopPropagation();
                          setActiveIdxAbs(idx);
                        }}
                        onMouseLeave={e => {
                          e.stopPropagation();
                          setActiveIdxAbs(null);
                        }}
                        onClick={e => {
                          e.stopPropagation();
                          setPinnedIdxAbs(idx);
                        }}
                      >
                        {d.surge && (
                          <circle
                            cx={x}
                            cy={bodyTop + bodyH / 2}
                            r={Math.max(10, bodyH)}
                            fill={isUp ? "#86efac" : "#fecaca"}
                            opacity="0.25"
                          />
                        )}
                        <line x1={x} x2={x} y1={yHigh} y2={yLow} stroke={color} strokeWidth="2" />
                        <rect
                          x={x - bodyW / 2}
                          y={bodyTop}
                          width={bodyW}
                          height={bodyH}
                          fill={color}
                          rx="2"
                          className={isActive ? "opacity-100" : "opacity-90"}
                        />
                        <text x={x} y={height - 5} textAnchor="middle" fontSize="10" fill="#6b7280">
                          {dateStr.slice(5)}
                        </text>
                      </g>
                    );
                  })}
                </svg>
              </div>

              <div className="mt-3 text-xs text-gray-500 flex items-center gap-2">
                <IconInfo /> {T.hint_hover}
              </div>
            </div>

            <div className="bg-white rounded-2xl shadow p-4">
              <div className="flex items-center justify-between mb-3">
                <div className="flex items-center gap-2">
                  <IconCalendar />
                  <h2 className="text-lg font-semibold">{T.timeline_title}</h2>
                </div>
                <div className="text-xs text-gray-500">{T.timeline_hint}</div>
              </div>

              <ul className="space-y-2">
                {events.map((ev, i) => {
                  const active = ev.idx === pinnedIdxAbs || ev.idx === activeIdxAbs;
                  const tMeta = TYPE_BADGE[ev.type] || TYPE_BADGE.policy;
                  return (
                    <li
                      key={i}
                      className={
                        "rounded-xl border p-3 flex items-start gap-3 cursor-pointer " +
                        (active ? "border-blue-400 bg-blue-50" : "hover:bg-gray-50")
                      }
                      onMouseEnter={() => setActiveIdxAbs(ev.idx)}
                      onMouseLeave={() => setActiveIdxAbs(null)}
                      onClick={() => {
                        setOffset(ev.idx);
                        setPinnedIdxAbs(ev.idx);
                      }}
                    >
                      <div className={"mt-1 w-2 h-2 rounded-full " + IMP_DOT[ev.importance]}></div>
                      <div className="flex-1">
                        <div className="flex flex-wrap items-center gap-2">
                          <span className={"text-[11px] px-2 py-0.5 rounded-full " + tMeta.class}>{tMeta.label}</span>
                          <span className="text-xs text-gray-500">
                            {ev.date} â€¢ {ev.time}
                          </span>
                        </div>
                        <div className="mt-1 font-medium">{ev.entity}</div>
                        <div className="text-sm text-gray-700">{ev.title}</div>
                      </div>
                    </li>
                  );
                })}
              </ul>

              <div className="mt-3 text-[11px] text-gray-400">{T.dummy_events_note}</div>
            </div>
          </div>

          <div className="lg:col-span-4">
            <div className="bg-white rounded-2xl shadow p-4 h-full flex flex-col">
              <div className="flex items-center gap-2 mb-3">
                <IconNews />
                <h3 className="font-semibold">{T.news_panel_title}</h3>
              </div>

              {current ? (
                <>
                  <div className="flex items-center justify-between mb-3">
                    <div className="flex items-center gap-2 text-sm text-gray-700">
                      <IconCalendar />
                      <span className="font-medium">{current.date}</span>
                    </div>
                    <button
                      className="text-xs px-2 py-1 rounded-full bg-gray-100 hover:bg-gray-200"
                      onClick={() => {
                        setPinnedIdxAbs(null);
                        setActiveIdxAbs(null);
                      }}
                    >
                      {T.clear}
                    </button>
                  </div>

                  <div className="mb-3">
                    <div className="text-gray-500 text-xs mb-1">{T.cat_label}</div>
                    <div className="flex flex-wrap gap-2">
                      {CATEGORY_LIST.map(cat => {
                        const label = cat.labelKo;
                        const active = cat.code === category;
                        return (
                          <button
                            key={cat.code}
                            type="button"
                            onClick={() => setCategory(cat.code)}
                            className={
                              "px-2.5 py-1 rounded-full text-xs border " +
                              (active
                                ? "bg-indigo-600 text-white border-indigo-600"
                                : "bg-white text-gray-700 border-gray-300 hover:bg-gray-100")
                            }
                          >
                            {label}
                          </button>
                        );
                      })}
                    </div>
                  </div>

                  <div>
                    <div className="text-gray-500 text-xs mb-1">{T.search_rankings}</div>
                    <div className="overflow-hidden rounded-xl border">
                      <table className="w-full text-sm">
                        <thead className="bg-gray-50">
                          <tr>
                            <th className="text-left px-3 py-2 w-16">{T.table_rank}</th>
                            <th className="text-left px-3 py-2">{T.table_title}</th>
                          </tr>
                        </thead>
                        <tbody>
                          {trendTitles.length > 0 ? (
                            trendTitles.map((title, i) => (
                              <tr key={i} className="border-t">
                                <td className="px-3 py-2 font-mono">#{i + 1}</td>
                                <td className="px-3 py-2">{title}</td>
                              </tr>
                            ))
                          ) : (
                            <tr className="border-t">
                              <td className="px-3 py-2 text-xs text-gray-400" colSpan={2}>
                                {trendStatus === "loading"
                                  ? T.loading_news
                                  : trendStatus === "error"
                                  ? T.error_news
                                  : "í•´ë‹¹ ë‚ ì§œì˜ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤."}
                              </td>
                            </tr>
                          )}
                        </tbody>
                      </table>
                    </div>
                  </div>
                </>
              ) : (
                <div className="text-sm text-gray-500">{T.empty_hint}</div>
              )}

              <div className="mt-auto pt-3 text-[11px] text-gray-400">{T.bottom_note}</div>
            </div>
          </div>
        </div>
      );
    }

    (function mountDemoWhenVisible() {
      const rootEl = document.getElementById("demo-root");
      if (!rootEl) return;

      if (!("IntersectionObserver" in window)) {
        ReactDOM.createRoot(rootEl).render(<DemoApp />);
        return;
      }
      const obs = new IntersectionObserver(
        entries => {
          entries.forEach(e => {
            if (e.isIntersecting) {
              ReactDOM.createRoot(rootEl).render(<DemoApp />);
              obs.disconnect();
            }
          });
        },
        { rootMargin: "200px" }
      );
      obs.observe(rootEl);
    })();
  </script>
</body>
</html>
